<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title> AMS Software: Geometry Classes: CC/TrParDB.C Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">CC</a></div>
<h1>TrParDB.C</h1><a href="TrParDB_8C.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">//  $Id: TrParDB.C,v 1.1 2008/06/23 14:07:53 oliva Exp $</span>
00002 
00014 
00015 <span class="preprocessor">#include "<a class="code" href="TrParDB_8h.html">TrParDB.h</a>"</span>
00016 
00017 <span class="preprocessor">#include "TFile.h"</span>
00018 
00019 <a class="code" href="TrTrack_8C.html#a0">ClassImp</a>(<a class="code" href="classTrParDB.html">TrParDB</a>);
00020 
<a name="l00021"></a><a class="code" href="classTrParDB.html#s0">00021</a> <a class="code" href="classTrParDB.html">TrParDB</a>* <a class="code" href="classTrParDB.html#s0">TrParDB::Head</a>=0;
00022 
00023 
00024 <span class="comment">//--------------------------------------------------</span>
<a name="l00025"></a><a class="code" href="classTrParDB.html#a3">00025</a> <span class="keywordtype">void</span> <a class="code" href="classTrParDB.html#a3">TrParDB::init</a>(){
00026   <span class="keywordflow">if</span> (<a class="code" href="classTrParDB.html#s0">Head</a>==0) {
00027     <a class="code" href="classTrParDB.html#s0">Head</a> = <span class="keyword">this</span>;
00028     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> oct=0; oct&lt;8; oct++){
00029       <span class="keywordtype">int</span> crate = TkDBc::Head-&gt;<a class="code" href="classTkDBc.html#o20">_octant_crate</a>[oct];
00030       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tdr=0; tdr&lt;24; tdr++) {
00031         <span class="keywordtype">int</span> hwid = crate*100+tdr;
00032         <a class="code" href="classTrParDB.html#o0">trpar_hwidmap</a>[hwid] = <span class="keyword">new</span> <a class="code" href="classTrLadPar.html">TrLadPar</a>(hwid);
00033       }
00034     }
00035   } 
00036   <span class="keywordflow">else</span>{ 
00037     printf(<span class="stringliteral">"Only one instance of TrParDB allowed.\n"</span>);
00038     printf(<span class="stringliteral">"Use TrParDB:Head-&gt;Load() to load a new parameters set.\n"</span>);
00039   }
00040 }
00041 
00042 <span class="comment">//--------------------------------------------------</span>
<a name="l00043"></a><a class="code" href="classTrParDB.html#a1">00043</a> <a class="code" href="classTrParDB.html#a0">TrParDB::TrParDB</a>(<span class="keywordtype">char</span> * filename){
00044   <span class="keywordflow">if</span> (filename) <a class="code" href="classTrParDB.html#e0">Load</a>(filename);
00045 }
00046 
00047 <span class="comment">//--------------------------------------------------</span>
<a name="l00048"></a><a class="code" href="classTrParDB.html#a2">00048</a> <a class="code" href="classTrParDB.html#a2">TrParDB::~TrParDB</a>() {
00049   <span class="keywordflow">for</span> (<a class="code" href="TrParDB_8h.html#a0">trparIT</a> pp=<a class="code" href="classTrParDB.html#o0">trpar_hwidmap</a>.begin(); pp!=<a class="code" href="classTrParDB.html#o0">trpar_hwidmap</a>.end(); ++pp)
00050     <span class="keywordflow">if</span>(pp-&gt;second) <span class="keyword">delete</span> pp-&gt;second;
00051 }
00052 
00053 <span class="comment">//--------------------------------------------------</span>
<a name="l00054"></a><a class="code" href="classTrParDB.html#a6">00054</a> <a class="code" href="classTrLadPar.html">TrLadPar</a>* <a class="code" href="classTrParDB.html#a6">TrParDB::FindPar_TkAssemblyId</a>(<span class="keywordtype">int</span> tkassemblyid) {
00055   <a class="code" href="classTkLadder.html">TkLadder</a>* ll = TkDBc::Head-&gt;<a class="code" href="classTkDBc.html#a21">FindTkAssemblyId</a>(tkassemblyid);
00056   <span class="keywordflow">if</span> (ll) <span class="keywordflow">return</span> <a class="code" href="classTrParDB.html#a9">FindPar_HwId</a>(ll-&gt;<a class="code" href="classTkLadder.html#a15">GetHwId</a>());
00057   <span class="keywordflow">else</span> <span class="keywordflow">return</span> 0;
00058 }
00059 
00060 
00061 <span class="comment">//--------------------------------------------------</span>
<a name="l00062"></a><a class="code" href="classTrParDB.html#a9">00062</a> <a class="code" href="classTrLadPar.html">TrLadPar</a>* <a class="code" href="classTrParDB.html#a9">TrParDB::FindPar_HwId</a>(<span class="keywordtype">int</span> hwid){ 
00063   <a class="code" href="TrParDB_8h.html#a0">trparIT</a> aa = <a class="code" href="classTrParDB.html#o0">trpar_hwidmap</a>.find(hwid);
00064   <span class="keywordflow">if</span> (aa!=<a class="code" href="classTrParDB.html#o0">trpar_hwidmap</a>.end()) <span class="keywordflow">return</span> aa-&gt;second; 
00065   <span class="keywordflow">else</span>                         <span class="keywordflow">return</span> 0;
00066 }
00067 
00068 <span class="comment">//--------------------------------------------------</span>
<a name="l00069"></a><a class="code" href="classTrParDB.html#a7">00069</a> <a class="code" href="classTrLadPar.html">TrLadPar</a>* <a class="code" href="classTrParDB.html#a7">TrParDB::FindPar_TkId</a>(<span class="keywordtype">int</span> tkid){
00070   <a class="code" href="classTkLadder.html">TkLadder</a>* ll = TkDBc::Head-&gt;<a class="code" href="classTkDBc.html#a22">FindTkId</a>(tkid);
00071   <span class="keywordflow">if</span> (ll) <span class="keywordflow">return</span> <a class="code" href="classTrParDB.html#a9">FindPar_HwId</a>(ll-&gt;<a class="code" href="classTkLadder.html#a15">GetHwId</a>());
00072   <span class="keywordflow">else</span>    <span class="keywordflow">return</span> 0;
00073 }
00074 
00075 <span class="comment">//--------------------------------------------------</span>
<a name="l00076"></a><a class="code" href="classTrParDB.html#a10">00076</a> <a class="code" href="classTrLadPar.html">TrLadPar</a>* <a class="code" href="classTrParDB.html#a10">TrParDB::FindPar_LadName</a>(string&amp; name){
00077   <a class="code" href="classTkLadder.html">TkLadder</a>* ll=TkDBc::Head-&gt;<a class="code" href="classTkDBc.html#a25">FindLadName</a>(name);
00078   <span class="keywordflow">if</span> (ll) <span class="keywordflow">return</span> <a class="code" href="classTrParDB.html#a9">FindPar_HwId</a>(ll-&gt;<a class="code" href="classTkLadder.html#a15">GetHwId</a>());
00079   <span class="keywordflow">else</span>    <span class="keywordflow">return</span> 0;
00080 }
00081 
00082 <span class="comment">//--------------------------------------------------</span>
<a name="l00083"></a><a class="code" href="classTrParDB.html#a8">00083</a> <a class="code" href="classTrLadPar.html">TrLadPar</a>* <a class="code" href="classTrParDB.html#a8">TrParDB::FindPar_JMDC</a>(<span class="keywordtype">int</span> JMDCid){
00084   <span class="keywordtype">int</span> crate = (JMDCid-282)/24;
00085   <span class="keywordtype">int</span> tdr   = JMDCid-crate*24-282;
00086   <span class="keywordtype">int</span> hwid  = crate*100+tdr;
00087   printf(<span class="stringliteral">" crate %d tdr %d hwid %d \n"</span>,crate,tdr,hwid);
00088   <span class="keywordflow">return</span> <a class="code" href="classTrParDB.html#a9">FindPar_HwId</a>(hwid);
00089 }
00090  
00091 <span class="comment">//--------------------------------------------------</span>
<a name="l00092"></a><a class="code" href="classTrParDB.html#a5">00092</a> <a class="code" href="classTrLadPar.html">TrLadPar</a>* <a class="code" href="classTrParDB.html#a5">TrParDB::GetEntry</a>(<span class="keywordtype">int</span> ii){
00093   <span class="keywordtype">int</span> count=0;
00094   <span class="keywordflow">for</span>(<a class="code" href="TrParDB_8h.html#a0">trparIT</a> pp=<a class="code" href="classTrParDB.html#o0">trpar_hwidmap</a>.begin();pp!=<a class="code" href="classTrParDB.html#o0">trpar_hwidmap</a>.end();pp++){
00095     <span class="keywordflow">if</span>(count==ii) <span class="keywordflow">return</span> &amp;(*pp-&gt;second);
00096     count++;
00097   }
00098   <span class="keywordflow">return</span> 0;
00099 }
00100 
00101 
00102 <span class="comment">//--------------------------------------------------</span>
<a name="l00103"></a><a class="code" href="classTrParDB.html#e0">00103</a> <span class="keywordtype">void</span> <a class="code" href="classTrParDB.html#e0">TrParDB::Load</a>(<span class="keywordtype">char</span> * filename){
00104   TFile f(filename);
00105   <a class="code" href="classTrParDB.html#s0">Head</a> = (<a class="code" href="classTrParDB.html">TrParDB</a>*) f.Get(<span class="stringliteral">"TrParDB"</span>);
00106   f.Close();
00107   <span class="keywordflow">return</span>;
00108 }
00109 
00110 <span class="comment">//--------------------------------------------------</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Nov 18 18:21:03 2008 for  AMS Software: Geometry Classes by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
