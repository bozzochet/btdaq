<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title> AMS Software: Geometry Classes: include/TrRawCluster.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000002.html">include</a></div>
<h1>TrRawCluster.h</h1><a href="TrRawCluster_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">// $Id: TrRawCluster.h,v 1.26 2008/11/05 17:39:05 zuccon Exp $ </span>
00002 <span class="preprocessor">#ifndef __TrRawCluster__</span>
00003 <span class="preprocessor"></span><span class="preprocessor">#define __TrRawCluster__</span>
00004 <span class="preprocessor"></span>
00023 <span class="preprocessor">#include "TObject.h"</span>
00024 <span class="preprocessor">#include "link.h"</span>
00025 <span class="preprocessor">#include "<a class="code" href="TrCalDB_8h.html">TrCalDB.h</a>"</span>
00026 <span class="preprocessor">#include "<a class="code" href="TrLadCal_8h.html">TrLadCal.h</a>"</span>
00027 
00028 <span class="preprocessor">#include &lt;iostream&gt;</span>
00029 <span class="preprocessor">#include &lt;vector&gt;</span>
00030 <span class="preprocessor">#include &lt;cstdlib&gt;</span>
00031 <span class="preprocessor">#include &lt;string&gt;</span>
00032 
00033 
00034 
00035 <span class="comment">//class AMSTrRawCluster : public AMSlink, public TObject {</span>
<a name="l00036"></a><a class="code" href="classAMSTrRawCluster.html">00036</a> <span class="keyword">class </span><a class="code" href="classAMSTrRawCluster.html">AMSTrRawCluster</a> : <span class="keyword">public</span> AMSlink {
00037  <span class="keyword">public</span>:
<a name="l00039"></a><a class="code" href="classAMSTrRawCluster.html#o0">00039</a>   <span class="keywordtype">short</span> <span class="keywordtype">int</span> _tkid;
<a name="l00041"></a><a class="code" href="classAMSTrRawCluster.html#o1">00041</a>   <span class="keywordtype">short</span> <span class="keywordtype">int</span> _address;
<a name="l00043"></a><a class="code" href="classAMSTrRawCluster.html#o2">00043</a>   <span class="keywordtype">short</span> <span class="keywordtype">int</span> _nelem;
00044    
<a name="l00046"></a><a class="code" href="classAMSTrRawCluster.html#o3">00046</a>   std::vector&lt;float&gt; _signal;
00047   
00048  <span class="keyword">protected</span>:
00050   <span class="keyword">static</span> <a class="code" href="classTrCalDB.html">TrCalDB</a>* _trcaldb;
00051   
00052  <span class="keyword">public</span>:
00054   <a class="code" href="classAMSTrRawCluster.html#a0">AMSTrRawCluster</a>(<span class="keywordtype">void</span>);
00056   <a class="code" href="classAMSTrRawCluster.html#a0">AMSTrRawCluster</a>(<span class="keyword">const</span> <a class="code" href="classAMSTrRawCluster.html">AMSTrRawCluster</a>&amp; orig);
00058   <a class="code" href="classAMSTrRawCluster.html#a0">AMSTrRawCluster</a>(<span class="keywordtype">int</span> tkid, <span class="keywordtype">int</span> add, <span class="keywordtype">int</span> nelem, <span class="keywordtype">short</span> <span class="keywordtype">int</span> *adc);
00059   <a class="code" href="classAMSTrRawCluster.html#a0">AMSTrRawCluster</a>(<span class="keywordtype">int</span> tkid, <span class="keywordtype">int</span> add, <span class="keywordtype">int</span> nelem, <span class="keywordtype">float</span> *adc);
00061   <a class="code" href="classAMSTrRawCluster.html#a4">~AMSTrRawCluster</a>();
00063   <span class="keywordtype">void</span> <a class="code" href="classAMSTrRawCluster.html#a5">Clear</a>();
00064 
<a name="l00066"></a><a class="code" href="classAMSTrRawCluster.html#e0">00066</a>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classAMSTrRawCluster.html#e0">UsingTrCalDB</a>(<a class="code" href="classTrCalDB.html">TrCalDB</a>* trcaldb) { <a class="code" href="classAMSTrRawCluster.html#t0">_trcaldb</a> = trcaldb; }
<a name="l00068"></a><a class="code" href="classAMSTrRawCluster.html#a6">00068</a>   <a class="code" href="classTrCalDB.html">TrCalDB</a>*    <a class="code" href="classAMSTrRawCluster.html#a6">GetTrCalDB</a>() { <span class="keywordflow">return</span> _trcaldb; }
00069 
<a name="l00071"></a><a class="code" href="classAMSTrRawCluster.html#a7">00071</a>   <span class="keywordtype">int</span> <a class="code" href="classAMSTrRawCluster.html#a7">GetTkId</a>()<span class="keyword">      const </span>{ <span class="keywordflow">return</span> _tkid; }
<a name="l00073"></a><a class="code" href="classAMSTrRawCluster.html#a8">00073</a>   <span class="keywordtype">int</span> <a class="code" href="classAMSTrRawCluster.html#a8">GetHwId</a>()<span class="keyword">      const</span>{
00074     <a class="code" href="classTkLadder.html">TkLadder</a>* lad=TkDBc::Head-&gt;<a class="code" href="classTkDBc.html#a22">FindTkId</a>(<a class="code" href="classAMSTrRawCluster.html#o0">_tkid</a>);
00075     <span class="keywordflow">if</span>(lad) <span class="keywordflow">return</span> lad-&gt;<a class="code" href="classTkLadder.html#a15">GetHwId</a>();
00076     <span class="keywordflow">else</span> <span class="keywordflow">return</span> -1;
00077   }
<a name="l00079"></a><a class="code" href="classAMSTrRawCluster.html#a9">00079</a>   <span class="keywordtype">int</span> <a class="code" href="classAMSTrRawCluster.html#a9">GetLayer</a>()<span class="keyword">     const </span>{ <span class="keywordflow">return</span> abs(<a class="code" href="classAMSTrRawCluster.html#o0">_tkid</a>/100); }
<a name="l00081"></a><a class="code" href="classAMSTrRawCluster.html#a10">00081</a>   <span class="keywordtype">int</span> <a class="code" href="classAMSTrRawCluster.html#a10">GetLayerSide</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (<a class="code" href="classAMSTrRawCluster.html#o0">_tkid</a>&gt;0)?1:-1; }
<a name="l00083"></a><a class="code" href="classAMSTrRawCluster.html#a11">00083</a>   <span class="keywordtype">int</span> <a class="code" href="classAMSTrRawCluster.html#a11">GetSlot</a>()<span class="keyword">      const </span>{ <span class="keywordflow">return</span> (abs(<a class="code" href="classAMSTrRawCluster.html#o0">_tkid</a>)-<a class="code" href="classAMSTrRawCluster.html#a9">GetLayer</a>()*100)*<a class="code" href="classAMSTrRawCluster.html#a10">GetLayerSide</a>(); }
<a name="l00085"></a><a class="code" href="classAMSTrRawCluster.html#a12">00085</a>   <span class="keywordtype">int</span> <a class="code" href="classAMSTrRawCluster.html#a12">GetSide</a>()<span class="keyword">      const </span>{ <span class="keywordflow">return</span>(<a class="code" href="classAMSTrRawCluster.html#o1">_address</a>&gt;639) ? 0 : 1; }
<a name="l00087"></a><a class="code" href="classAMSTrRawCluster.html#a13">00087</a>   <span class="keywordtype">int</span> <a class="code" href="classAMSTrRawCluster.html#a13">GetAddress</a>()<span class="keyword">   const </span>{ <span class="keywordflow">return</span> _address; }
<a name="l00089"></a><a class="code" href="classAMSTrRawCluster.html#a14">00089</a>   <span class="keywordtype">int</span> <a class="code" href="classAMSTrRawCluster.html#a13">GetAddress</a>(<span class="keywordtype">int</span> ii)   { <span class="keywordflow">return</span> <a class="code" href="classAMSTrRawCluster.html#a13">GetAddress</a>() + ii; } 
<a name="l00091"></a><a class="code" href="classAMSTrRawCluster.html#a15">00091</a>   <span class="keywordtype">int</span> <a class="code" href="classAMSTrRawCluster.html#a15">GetNelem</a>()<span class="keyword">     const </span>{ <span class="keywordflow">return</span> _nelem; }
00092  <span class="comment">//  /// Get the gain</span>
00093 <span class="comment">//   double GetGain()   const { return _gain; }</span>
<a name="l00095"></a><a class="code" href="classAMSTrRawCluster.html#a16">00095</a> <span class="comment"></span>  <span class="keywordtype">float</span> <a class="code" href="classAMSTrRawCluster.html#a16">GetSignal</a>(<span class="keywordtype">int</span> ii)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classAMSTrRawCluster.html#o3">_signal</a>.at(ii); }
<a name="l00097"></a><a class="code" href="classAMSTrRawCluster.html#a17">00097</a>   <span class="keywordtype">float</span> <a class="code" href="classAMSTrRawCluster.html#a17">GetSigma</a> (<span class="keywordtype">int</span> ii) { <span class="keywordflow">return</span> <a class="code" href="classAMSTrRawCluster.html#a18">GetNoise</a>(ii); }
00099   <span class="keywordtype">float</span> <a class="code" href="classAMSTrRawCluster.html#a18">GetNoise</a>(<span class="keywordtype">int</span> ii);   
<a name="l00101"></a><a class="code" href="classAMSTrRawCluster.html#a19">00101</a>   <span class="keywordtype">float</span> <a class="code" href="classAMSTrRawCluster.html#a19">GetSN</a>(<span class="keywordtype">int</span> ii, <span class="keyword">const</span> <span class="keywordtype">char</span>* options = <span class="stringliteral">"AG"</span>) { <span class="keywordflow">return</span> (<a class="code" href="classAMSTrRawCluster.html#a18">GetNoise</a>(ii)&lt;=0.) ? -9999. : <a class="code" href="classAMSTrRawCluster.html#a16">GetSignal</a>(ii)/<a class="code" href="classAMSTrRawCluster.html#a18">GetNoise</a>(ii); }
00102 
00104   <span class="keywordtype">short</span> <a class="code" href="classAMSTrRawCluster.html#a20">GetStatus</a>(<span class="keywordtype">int</span> ii);
00105   <span class="comment">/*</span>
00106 <span class="comment">    Status definition (thresholds...???):</span>
00107 <span class="comment">    bit 0 set to 1: dead channel on the sigma raw base (pedestal subtraction)</span>
00108 <span class="comment">    bit 1 set to 1: noisy channel on the sigma raw base (pedestal subtraction) </span>
00109 <span class="comment">    bit 2 set to 1: dead channel on the sigma base (pedestal and CN subtraction)</span>
00110 <span class="comment">    bit 3 set to 1: noisy channel on the sigma base (pedestal and CN subtraction)</span>
00111 <span class="comment">    bit 4 set to 1: non gaussian channel </span>
00112 <span class="comment">  */</span>
<a name="l00114"></a><a class="code" href="classAMSTrRawCluster.html#a21">00114</a>   <span class="keywordtype">int</span> <a class="code" href="classAMSTrRawCluster.html#a21">CheckSide</a>(<span class="keywordtype">int</span> side)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (side == 0) ? (640 &lt;= <a class="code" href="classAMSTrRawCluster.html#o1">_address</a>+_nelem) : (<a class="code" href="classAMSTrRawCluster.html#o1">_address</a> &lt; 640); }
00115 
00117   std::ostream&amp; <a class="code" href="classAMSTrRawCluster.html#a22">putout</a>(std::ostream &amp;ostr = std::cout) <span class="keyword">const</span>;
00119   <span class="keyword">friend</span> std::ostream &amp;<span class="keyword">operator</span> &lt;&lt; 
<a name="l00120"></a><a class="code" href="classAMSTrRawCluster.html#n0">00120</a>     (std::ostream &amp;ostr, <span class="keyword">const</span> <a class="code" href="classAMSTrRawCluster.html">AMSTrRawCluster</a> &amp;cls) { 
00121     <span class="keywordflow">return</span> cls.<a class="code" href="classTkLadder.html#b0">putout</a>(ostr);
00122   }
00124   <span class="keywordtype">void</span> <a class="code" href="classAMSTrRawCluster.html#a23">Print</a>();
00125   <span class="keywordtype">void</span> <a class="code" href="classAMSTrRawCluster.html#a24">Info</a>();
00126 
00128   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrRawCluster.html#a25">GetSeedIndex</a>(<span class="keywordtype">float</span> thseed = 3.);
00130   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrRawCluster.html#a26">GetSeedAddress</a>(<span class="keywordtype">float</span> thseed = 3.);
00132   <span class="keywordtype">float</span> <a class="code" href="classAMSTrRawCluster.html#a27">GetSeedSignal</a>(<span class="keywordtype">float</span> thseed = 3.);
00134   <span class="keywordtype">float</span> <a class="code" href="classAMSTrRawCluster.html#a28">GetSeedNoise</a>(<span class="keywordtype">float</span> thseed = 3.);
00136   <span class="keywordtype">float</span> <a class="code" href="classAMSTrRawCluster.html#a29">GetSeedSN</a>(<span class="keywordtype">float</span> thseed = 3.);
00138   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrRawCluster.html#a30">GetLeftLength</a>(<span class="keywordtype">float</span> thseed = 3.,<span class="keywordtype">float</span> thneig = 1.);
00140   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrRawCluster.html#a31">GetRightLength</a>(<span class="keywordtype">float</span> thseed = 3.,<span class="keywordtype">float</span> thneig = 1.);
00142   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrRawCluster.html#a32">GetLength</a>(<span class="keywordtype">float</span> thseed = 3.,<span class="keywordtype">float</span> thneig = 1.);
00144   <span class="keywordtype">float</span> <a class="code" href="classAMSTrRawCluster.html#a33">GetTotSignal</a>(<span class="keywordtype">float</span> thseed = 3.,<span class="keywordtype">float</span> thneig = 1.);
00145   <span class="keywordtype">float</span> <a class="code" href="classAMSTrRawCluster.html#a34">GetTotSignal2</a>(<span class="keywordtype">float</span> thseed = 3.,<span class="keywordtype">float</span> thneig = 1.);
00147   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrRawCluster.html#a35">GetStatusnStrips</a>(<span class="keywordtype">int</span> nstrips, <span class="keywordtype">float</span> thseed = 3., <span class="keywordtype">float</span> thneig = 1.);
00149   <span class="keywordtype">float</span> <a class="code" href="classAMSTrRawCluster.html#a36">GetEta</a>(<span class="keywordtype">float</span> thseed = 3.,<span class="keywordtype">float</span> thneig = 1.);
00151   <span class="keywordtype">float</span> <a class="code" href="classAMSTrRawCluster.html#a37">GetEtaAddress</a>(<span class="keywordtype">float</span> thseed = 3., <span class="keywordtype">float</span> thneig = 1.);
00153   integer <a class="code" href="classAMSTrRawCluster.html#a38">AMSTrRawCluster::lvl3format</a>(int16 * adc, integer nmax,<span class="keywordtype">int</span> lvl3dcard_par=1  ,integer matchedonly=0);
00154 
00155   <span class="keyword">static</span> std::string sout;
00156 
<a name="l00157"></a><a class="code" href="classAMSTrRawCluster.html#e1">00157</a>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classAMSTrRawCluster.html#e1">lvl3CompatibilityAddress</a>(
00158       int16u address,
00159       integer &amp; strip, integer &amp; va, integer &amp; side,  integer &amp;drp){
00160     drp=address%100;
00161     strip=address/1000;
00162     va=strip/64;
00163     side=va&gt;9 ? 0 : 1;
00164   }
00165 
00166 
<a name="l00167"></a><a class="code" href="classAMSTrRawCluster.html#a39">00167</a>   <a class="code" href="classAMSTrRawCluster.html">AMSTrRawCluster</a>* <a class="code" href="classAMSTrRawCluster.html#a39">next</a>(){ <span class="keywordflow">return</span> (<a class="code" href="classAMSTrRawCluster.html">AMSTrRawCluster</a>*) _next;}
<a name="l00168"></a><a class="code" href="classAMSTrRawCluster.html#a40">00168</a>   <span class="keywordtype">void</span> <a class="code" href="classAMSTrRawCluster.html#a40">_copyEl</a>(){}
<a name="l00169"></a><a class="code" href="classAMSTrRawCluster.html#a41">00169</a>   <span class="keywordtype">void</span> <a class="code" href="classAMSTrRawCluster.html#a41">_printEl</a>(std::ostream&amp;){}
<a name="l00170"></a><a class="code" href="classAMSTrRawCluster.html#a42">00170</a>   <span class="keywordtype">void</span> <a class="code" href="classAMSTrRawCluster.html#a42">_writeEl</a>(){}
<a name="l00171"></a><a class="code" href="classAMSTrRawCluster.html#a43">00171</a>   <span class="keywordtype">void</span> * <a class="code" href="classAMSTrRawCluster.html#a43">operator new</a>(size_t t) {<span class="keywordflow">return</span> TObject::operator new(t); }
<a name="l00172"></a><a class="code" href="classAMSTrRawCluster.html#a44">00172</a>   <span class="keywordtype">void</span> <a class="code" href="classAMSTrRawCluster.html#a44">operator delete</a>(<span class="keywordtype">void</span> *p)   {TObject::operator delete(p);p=0;}
00173 
00174 
00176   ClassDef(<a class="code" href="classAMSTrRawCluster.html">AMSTrRawCluster</a>, 1)
00177 };
<a name="l00178"></a><a class="code" href="TrRawCluster_8h.html#a0">00178</a> <span class="keyword">typedef</span> <a class="code" href="classAMSTrRawCluster.html">AMSTrRawCluster</a> <a class="code" href="classAMSTrRawCluster.html">TrRawClusterR</a>;
00179 <span class="preprocessor">#endif</span>
00180 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Nov 18 18:21:04 2008 for  AMS Software: Geometry Classes by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
