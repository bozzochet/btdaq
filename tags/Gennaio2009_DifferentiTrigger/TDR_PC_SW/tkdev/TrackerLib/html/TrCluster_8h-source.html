<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title> AMS Software: Geometry Classes: include/TrCluster.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000002.html">include</a></div>
<h1>TrCluster.h</h1><a href="TrCluster_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">// $Id: TrCluster.h,v 1.39 2008/11/06 18:35:51 zuccon Exp $ </span>
00002 <span class="preprocessor">#ifndef __AMSTrCluster__</span>
00003 <span class="preprocessor"></span><span class="preprocessor">#define __AMSTrCluster__</span>
00004 <span class="preprocessor"></span>
00005 <span class="preprocessor">#include "<a class="code" href="TrRawCluster_8h.html">TrRawCluster.h</a>"</span>
00006 <span class="preprocessor">#include "<a class="code" href="TkDBc_8h.html">TkDBc.h</a>"</span>
00007 <span class="preprocessor">#include "<a class="code" href="TrCalDB_8h.html">TrCalDB.h</a>"</span>
00008 <span class="preprocessor">#include "<a class="code" href="TrLadCal_8h.html">TrLadCal.h</a>"</span>
00009 <span class="preprocessor">#include "<a class="code" href="TkCoo_8h.html">TkCoo.h</a>"</span>
00010 <span class="preprocessor">#include "link.h"</span>
00011 <span class="preprocessor">#include &lt;cmath&gt;</span>
00012 <span class="preprocessor">#include &lt;vector&gt;</span>
00013 <span class="preprocessor">#include &lt;string&gt;</span>
00043 <span class="comment">//class AMSTrCluster : public TObject, public AMSlink {</span>
<a name="l00044"></a><a class="code" href="classAMSTrCluster.html">00044</a> <span class="keyword">class </span><a class="code" href="classAMSTrCluster.html">AMSTrCluster</a> : <span class="keyword">public</span> AMSlink{
00045 
00046 <span class="keyword">private</span>:
<a name="l00048"></a><a class="code" href="classAMSTrCluster.html#r0">00048</a>   vector&lt;float&gt; _coord; 
00049  
00050  <span class="keyword">public</span>:
<a name="l00052"></a><a class="code" href="classAMSTrCluster.html#o0">00052</a>   <span class="keywordtype">short</span> <span class="keywordtype">int</span>    _tkid;
<a name="l00054"></a><a class="code" href="classAMSTrCluster.html#o1">00054</a>   <span class="keywordtype">short</span> <span class="keywordtype">int</span>    _address;
<a name="l00056"></a><a class="code" href="classAMSTrCluster.html#o2">00056</a>   <span class="keywordtype">short</span> <span class="keywordtype">int</span>    _nelem;
<a name="l00058"></a><a class="code" href="classAMSTrCluster.html#o3">00058</a>   <span class="keywordtype">short</span> <span class="keywordtype">int</span>    _seedind;
<a name="l00060"></a><a class="code" href="classAMSTrCluster.html#o4">00060</a>   std::vector&lt;float&gt; _signal;
<a name="l00062"></a><a class="code" href="classAMSTrCluster.html#o5">00062</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>       _clstatus;
<a name="l00064"></a><a class="code" href="classAMSTrCluster.html#o6">00064</a>   <span class="keywordtype">short</span> <span class="keywordtype">int</span> _mult;
00065 
00066  <span class="keyword">protected</span>:
00067 
00070   <span class="keyword">static</span> <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#t0">AsimmetryCorr</a>[2];
00072   <span class="keyword">static</span> <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#t1">GainCorr</a>[2];
00074   <span class="keyword">static</span> <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#t2">ChargeLossCorr</a>[2][3];
00075  
00077   <span class="keyword">static</span> <a class="code" href="classTrCalDB.html">TrCalDB</a>* _trcaldb;
00078  
00079  <span class="keyword">public</span>:
00081   <a class="code" href="classAMSTrCluster.html#a0">AMSTrCluster</a>(<span class="keywordtype">void</span>);
00083   <a class="code" href="classAMSTrCluster.html#a0">AMSTrCluster</a>(<span class="keywordtype">int</span> tkid, <span class="keywordtype">int</span> side, <span class="keywordtype">int</span> add, <span class="keywordtype">int</span> nelem, <span class="keywordtype">int</span> seedind, <span class="keywordtype">float</span>* adc, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> clstatus);
00085   <a class="code" href="classAMSTrCluster.html#a0">AMSTrCluster</a>(<span class="keywordtype">int</span> tkid, <span class="keywordtype">int</span> side, <span class="keywordtype">int</span> add, <span class="keywordtype">int</span> seedind, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> clstatus);
00087   <span class="keywordtype">void</span> <a class="code" href="classAMSTrCluster.html#a3">push_back</a>(<span class="keywordtype">float</span> adc);
00089   <span class="keywordtype">void</span> <a class="code" href="classAMSTrCluster.html#a4">BuildCoordinates</a>();
00091   <a class="code" href="classAMSTrCluster.html#a0">AMSTrCluster</a>(<span class="keyword">const</span> <a class="code" href="classAMSTrCluster.html">AMSTrCluster</a>&amp; orig);
00093   <a class="code" href="classAMSTrCluster.html#a6">~AMSTrCluster</a>();
00095   <span class="keywordtype">void</span> <a class="code" href="classAMSTrCluster.html#a7">Clear</a>();
00096 
<a name="l00098"></a><a class="code" href="classAMSTrCluster.html#e0">00098</a>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classAMSTrCluster.html#e0">UsingTrCalDB</a>(<a class="code" href="classTrCalDB.html">TrCalDB</a>* trcaldb) { <a class="code" href="classAMSTrCluster.html#t3">_trcaldb</a> = trcaldb; }
<a name="l00100"></a><a class="code" href="classAMSTrCluster.html#a8">00100</a>   <a class="code" href="classTrCalDB.html">TrCalDB</a>*    <a class="code" href="classAMSTrCluster.html#a8">GetTrCalDB</a>() { <span class="keywordflow">return</span> _trcaldb; }
00101 
<a name="l00103"></a><a class="code" href="classAMSTrCluster.html#a9">00103</a>   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrCluster.html#a9">GetTkId</a>()<span class="keyword">          const </span>{ <span class="keywordflow">return</span> _tkid; }
<a name="l00105"></a><a class="code" href="classAMSTrCluster.html#a10">00105</a>   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrCluster.html#a10">GetLayer</a>()<span class="keyword">         const </span>{ <span class="keywordflow">return</span> abs(<a class="code" href="classAMSTrCluster.html#o0">_tkid</a>/100); }
<a name="l00107"></a><a class="code" href="classAMSTrCluster.html#a11">00107</a>   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrCluster.html#a11">GetSlot</a>()<span class="keyword">          const </span>{ <span class="keywordflow">return</span> abs(<a class="code" href="classAMSTrCluster.html#o0">_tkid</a>%100); }
<a name="l00109"></a><a class="code" href="classAMSTrCluster.html#a12">00109</a>   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrCluster.html#a12">GetSide</a>()<span class="keyword">          const </span>{ <span class="keywordflow">return</span> (<a class="code" href="classAMSTrCluster.html#o1">_address</a>&lt;640)?1:0; }
<a name="l00111"></a><a class="code" href="classAMSTrCluster.html#a13">00111</a>   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrCluster.html#a13">GetAddress</a>()<span class="keyword">       const </span>{ <span class="keywordflow">return</span> _address; }
00113   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrCluster.html#a13">GetAddress</a>(<span class="keywordtype">int</span> ii);
<a name="l00115"></a><a class="code" href="classAMSTrCluster.html#a15">00115</a>   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrCluster.html#a15">GetNelem</a>()<span class="keyword">         const </span>{ <span class="keywordflow">return</span> _nelem; }
00117   <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#a16">GetSignal</a>(<span class="keywordtype">int</span> ii, <span class="keyword">const</span> <span class="keywordtype">char</span>* options = <span class="stringliteral">"AG"</span>);
<a name="l00119"></a><a class="code" href="classAMSTrCluster.html#a17">00119</a>   <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#a17">GetSigma</a>(<span class="keywordtype">int</span> ii) { <span class="keywordflow">return</span> <a class="code" href="classAMSTrCluster.html#a18">GetNoise</a>(ii);  }
00121   <span class="comment">// float GetNoise(int ii)   const { return _sigma.at(ii);  }</span>
00122   <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#a18">GetNoise</a>(<span class="keywordtype">int</span> ii);   
<a name="l00124"></a><a class="code" href="classAMSTrCluster.html#a19">00124</a>   <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#a19">GetSN</a>(<span class="keywordtype">int</span> ii, <span class="keyword">const</span> <span class="keywordtype">char</span>* options = <span class="stringliteral">"AG"</span>) { <span class="keywordflow">return</span> (<a class="code" href="classAMSTrCluster.html#a18">GetNoise</a>(ii)&lt;=0.) ? -9999. : <a class="code" href="classAMSTrCluster.html#a16">GetSignal</a>(ii,options)/<a class="code" href="classAMSTrCluster.html#a18">GetNoise</a>(ii); }
00126   <span class="comment">// short GetStatus(int ii)  const { return _status.at(ii); }</span>
00127   <span class="keywordtype">short</span> <a class="code" href="classAMSTrCluster.html#a20">GetStatus</a>(<span class="keywordtype">int</span> ii);
00128 <span class="comment">//   /// Get gain </span>
00129 <span class="comment">//   float GetGain()          const { return _gain; }</span>
<a name="l00131"></a><a class="code" href="classAMSTrCluster.html#a21">00131</a> <span class="comment"></span>  <span class="keywordtype">int</span>   <a class="code" href="classAMSTrCluster.html#a21">GetClusterStatus</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _clstatus; } 
<a name="l00133"></a><a class="code" href="classAMSTrCluster.html#a22">00133</a>   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrCluster.html#a22">GetMultiplicity</a>()<span class="keyword">   const </span>{ <span class="keywordflow">return</span> _mult; }
00134   <span class="comment">//int GetMultiplicity() { return TkCoo::GetMaxMult(GetTkId(),GetAddress())+1; }</span>
00136 <span class="comment"></span>  <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#a23">GetCoord</a>(<span class="keywordtype">int</span> imult); 
<a name="l00138"></a><a class="code" href="classAMSTrCluster.html#a24">00138</a>   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrCluster.html#a24">GetSeedIndex</a>()   { <span class="keywordflow">return</span> _seedind; }
<a name="l00140"></a><a class="code" href="classAMSTrCluster.html#a25">00140</a>   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrCluster.html#a25">GetSeedAddress</a>() { <span class="keywordflow">return</span> <a class="code" href="classAMSTrCluster.html#a13">GetAddress</a>(<a class="code" href="classAMSTrCluster.html#a24">GetSeedIndex</a>()); }
<a name="l00142"></a><a class="code" href="classAMSTrCluster.html#a26">00142</a>   <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#a26">GetSeedSignal</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* options = <span class="stringliteral">"AG"</span>)  { <span class="keywordflow">return</span> <a class="code" href="classAMSTrCluster.html#a16">GetSignal</a>(<a class="code" href="classAMSTrCluster.html#a24">GetSeedIndex</a>(),options); }
<a name="l00144"></a><a class="code" href="classAMSTrCluster.html#a27">00144</a>   <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#a27">GetSeedNoise</a>()   { <span class="keywordflow">return</span> <a class="code" href="classAMSTrCluster.html#a18">GetNoise</a>(<a class="code" href="classAMSTrCluster.html#a24">GetSeedIndex</a>()); }
<a name="l00146"></a><a class="code" href="classAMSTrCluster.html#a28">00146</a>   <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#a28">GetSeedSN</a>()      { <span class="keywordflow">return</span> <a class="code" href="classAMSTrCluster.html#a19">GetSN</a>(<a class="code" href="classAMSTrCluster.html#a24">GetSeedIndex</a>()); }
<a name="l00148"></a><a class="code" href="classAMSTrCluster.html#a29">00148</a>   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrCluster.html#a29">GetLeftLength</a>()  { <span class="keywordflow">return</span> <a class="code" href="classAMSTrCluster.html#a24">GetSeedIndex</a>(); }
<a name="l00150"></a><a class="code" href="classAMSTrCluster.html#a30">00150</a>   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrCluster.html#a30">GetRightLength</a>() { <span class="keywordflow">return</span> <a class="code" href="classAMSTrCluster.html#a15">GetNelem</a>() - <a class="code" href="classAMSTrCluster.html#a24">GetSeedIndex</a>() - 1; } 
<a name="l00152"></a><a class="code" href="classAMSTrCluster.html#a31">00152</a>   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrCluster.html#a31">GetLength</a>()      { <span class="keywordflow">return</span> <a class="code" href="classAMSTrCluster.html#a15">GetNelem</a>(); }
00154   <span class="comment">/*</span>
00155 <span class="comment">    options:</span>
00156 <span class="comment">    A: apply asimmetry correction (signal)</span>
00157 <span class="comment">    I: apply inclination correction (???)</span>
00158 <span class="comment">    L: apply charge loss correction</span>
00159 <span class="comment">    G: apply gain correction </span>
00160 <span class="comment">    N: apply the p/n normalization</span>
00161 <span class="comment">  */</span>
00162   <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#a32">GetTotSignal</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* options = <span class="stringliteral">"ALG"</span>);
00165   <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#a33">GetEta</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* options = <span class="stringliteral">"AG"</span>);
00168   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrCluster.html#a34">GetEtaIndex</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* options = <span class="stringliteral">"AG"</span>);
00170   <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#a35">GetCofG</a>(<span class="keywordtype">int</span> nstrips=2, <span class="keyword">const</span> <span class="keywordtype">char</span>* options = <span class="stringliteral">"AG"</span>);
00171 
<a name="l00173"></a><a class="code" href="classAMSTrCluster.html#a36">00173</a>   <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#a36">GetX</a>(<span class="keywordtype">int</span> ii, <span class="keywordtype">int</span> imult = 0) { <span class="keywordflow">return</span> <a class="code" href="classTkCoo.html#e2">TkCoo::GetLocalCoo</a>(<a class="code" href="classAMSTrCluster.html#a9">GetTkId</a>(),<a class="code" href="classAMSTrCluster.html#a13">GetAddress</a>(ii),imult); }
00175   <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#a36">GetX</a>(<span class="keywordtype">float</span> interpos, <span class="keywordtype">int</span> imult = 0);
00177   <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#a38">GetXEta</a>(<span class="keywordtype">int</span> imult = 0, <span class="keyword">const</span> <span class="keywordtype">char</span>* options = <span class="stringliteral">"AG"</span>);
00179   <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#a39">GetXCofG</a>(<span class="keywordtype">int</span> nstrips, <span class="keywordtype">int</span> imult = 0, <span class="keyword">const</span> <span class="keywordtype">char</span>* options = <span class="stringliteral">"AG"</span>);
00180 
00182 
00183 
00184   <span class="comment">// - useful for eta analysis - //</span>
00186 <span class="comment"></span>  <span class="keywordtype">int</span>   <a class="code" href="classAMSTrCluster.html#a40">GetSecondIndex</a>();
<a name="l00188"></a><a class="code" href="classAMSTrCluster.html#a41">00188</a>   <span class="keywordtype">int</span>   <a class="code" href="classAMSTrCluster.html#a41">GetSecondAddress</a>() { <span class="keywordflow">return</span> (<a class="code" href="classAMSTrCluster.html#a40">GetSecondIndex</a>()==0) ? <a class="code" href="classAMSTrCluster.html#a13">GetAddress</a>()+<a class="code" href="classAMSTrCluster.html#a40">GetSecondIndex</a>() : -1; }
<a name="l00190"></a><a class="code" href="classAMSTrCluster.html#a42">00190</a>   <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#a42">GetSecondSignal</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* options = <span class="stringliteral">"AG"</span>)  { <span class="keywordflow">return</span> (<a class="code" href="classAMSTrCluster.html#a40">GetSecondIndex</a>()==0) ? <a class="code" href="classAMSTrCluster.html#a16">GetSignal</a>(<a class="code" href="classAMSTrCluster.html#a40">GetSecondIndex</a>(),options) : 0.; }
<a name="l00192"></a><a class="code" href="classAMSTrCluster.html#a43">00192</a>   <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#a43">GetSecondNoise</a>()   { <span class="keywordflow">return</span> (<a class="code" href="classAMSTrCluster.html#a40">GetSecondIndex</a>()==0) ? <a class="code" href="classAMSTrCluster.html#a18">GetNoise</a>(<a class="code" href="classAMSTrCluster.html#a40">GetSecondIndex</a>()) : -1.; }
<a name="l00194"></a><a class="code" href="classAMSTrCluster.html#a44">00194</a>   <span class="keywordtype">float</span> <a class="code" href="classAMSTrCluster.html#a44">GetSecondSN</a>()      { <span class="keywordflow">return</span> <a class="code" href="classAMSTrCluster.html#a42">GetSecondSignal</a>()/<a class="code" href="classAMSTrCluster.html#a43">GetSecondNoise</a>(); } 
00195 
00196 
00198   std::ostream&amp; <a class="code" href="classAMSTrCluster.html#a45">putout</a>(std::ostream &amp;ostr = std::cout) <span class="keyword">const</span>;
<a name="l00199"></a><a class="code" href="classAMSTrCluster.html#n0">00199</a>   <span class="keyword">friend</span> std::ostream &amp;<a class="code" href="classAMSTrCluster.html#n0">operator &lt;&lt; </a>(std::ostream &amp;ostr, <span class="keyword">const</span> <a class="code" href="classAMSTrCluster.html">AMSTrCluster</a> &amp;cls) { <span class="keywordflow">return</span> cls.<a class="code" href="classAMSTrCluster.html#a45">putout</a>(ostr); }
00201   <span class="keywordtype">void</span> <a class="code" href="classAMSTrCluster.html#a46">Print</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* options = <span class="stringliteral">"AG"</span>);
00202   <span class="keywordtype">void</span> <a class="code" href="classAMSTrCluster.html#a47">Info</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* options = <span class="stringliteral">"AG"</span>);
00203 
00204   <span class="keyword">static</span> string sout;
00205 
<a name="l00206"></a><a class="code" href="classAMSTrCluster.html#a48">00206</a>   <span class="keywordtype">void</span> <a class="code" href="classAMSTrCluster.html#a48">_copyEl</a>(){}
<a name="l00207"></a><a class="code" href="classAMSTrCluster.html#a49">00207</a>   <span class="keywordtype">void</span> <a class="code" href="classAMSTrCluster.html#a49">_printEl</a>(std::ostream&amp; ostr){  <a class="code" href="classAMSTrCluster.html#a45">putout</a>(ostr); }
<a name="l00208"></a><a class="code" href="classAMSTrCluster.html#a50">00208</a>   <span class="keywordtype">void</span> <a class="code" href="classAMSTrCluster.html#a50">_writeEl</a>(){}
00209 
<a name="l00210"></a><a class="code" href="classAMSTrCluster.html#a51">00210</a>    <span class="keywordtype">void</span> * <a class="code" href="classAMSTrCluster.html#a51">operator new</a>(size_t t) {<span class="keywordflow">return</span> TObject::operator new(t); }
<a name="l00211"></a><a class="code" href="classAMSTrCluster.html#a52">00211</a>    <span class="keywordtype">void</span> <a class="code" href="classAMSTrCluster.html#a52">operator delete</a>(<span class="keywordtype">void</span> *p)   {TObject::operator delete(p);p=0;}
00212 
<a name="l00213"></a><a class="code" href="classAMSTrCluster.html#a53">00213</a>   <a class="code" href="classAMSTrCluster.html">AMSTrCluster</a>* <a class="code" href="classAMSTrCluster.html#a53">next</a>(){ <span class="keywordflow">return</span> (<a class="code" href="classAMSTrCluster.html">AMSTrCluster</a>*) _next;}
00215   ClassDef(<a class="code" href="classAMSTrCluster.html">AMSTrCluster</a>, 1)
00216 };
<a name="l00217"></a><a class="code" href="TrCluster_8h.html#a0">00217</a> <span class="keyword">typedef</span> <a class="code" href="classAMSTrCluster.html">AMSTrCluster</a> <a class="code" href="classAMSTrCluster.html">TrClusterR</a>;
00218 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Nov 18 18:21:04 2008 for  AMS Software: Geometry Classes by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
