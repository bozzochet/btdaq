<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title> AMS Software: Geometry Classes: CC/TrMCCluster.C Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">CC</a></div>
<h1>TrMCCluster.C</h1><a href="TrMCCluster_8C.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">//  $Id: TrMCCluster.C,v 1.3 2008/09/11 16:56:02 zuccon Exp $</span>
00002 
00016 
00017 <span class="preprocessor">#include "<a class="code" href="TkDBc_8h.html">TkDBc.h</a>"</span>
00018 <span class="preprocessor">#include "<a class="code" href="TkCoo_8h.html">TkCoo.h</a>"</span>
00019 <span class="preprocessor">#include "<a class="code" href="TkSens_8h.html">TkSens.h</a>"</span>
00020 <span class="preprocessor">#include "<a class="code" href="tkdcards_8h.html">tkdcards.h</a>"</span>
00021 <span class="preprocessor">#include &lt;cmath&gt;</span>
00022 <span class="preprocessor">#include "<a class="code" href="TrMCCluster_8h.html">TrMCCluster.h</a>"</span>
00023 <span class="preprocessor">#include &lt;cstdlib&gt;</span>
00024 
00025 
00026 
00027 <a class="code" href="TrTrack_8C.html#a0">ClassImp</a>(<a class="code" href="classAMSTrMCCluster.html">AMSTrMCCluster</a>);
00028 
00029 <span class="keywordtype">int</span> <a class="code" href="classAMSTrMCCluster.html#s0">AMSTrMCCluster::_NoiseMarker</a>(555);
00030 
00031 
00032 <span class="keyword">extern</span> <span class="stringliteral">"C"</span> <span class="keywordtype">double</span> <a class="code" href="TrDigi_8C.html#a0">rnormx</a>();
00033 
<a name="l00034"></a><a class="code" href="classAMSTrMCCluster.html#a0">00034</a> <span class="keywordtype">void</span> <a class="code" href="classAMSTrMCCluster.html#a0">AMSTrMCCluster::_shower</a>()
00035 {
00036 
00037 
00038   AMSPoint entry  = (<a class="code" href="classAMSTrMCCluster.html#o7">_xca</a>+_xcb)/2.;
00039   AMSPoint dentry = (<a class="code" href="classAMSTrMCCluster.html#o8">_xcb</a>-_xca)/2;
00040   AMSDir   dir    =  <a class="code" href="classAMSTrMCCluster.html#o8">_xcb</a>-_xca;
00041 
00042   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 5; i++) <a class="code" href="classAMSTrMCCluster.html#o6">_ss</a>[0][i] = <a class="code" href="classAMSTrMCCluster.html#o6">_ss</a>[1][i] = 0;
00043 
00044   <span class="keywordtype">int</span> sensor = abs(<a class="code" href="classAMSTrMCCluster.html#o1">_idsoft</a>)/10000;
00045   <span class="keywordtype">int</span> tkid   = abs(<a class="code" href="classAMSTrMCCluster.html#o1">_idsoft</a>)%1000;
00046   <span class="keywordtype">int</span> ss     = abs(<a class="code" href="classAMSTrMCCluster.html#o1">_idsoft</a>)%10000-tkid;
00047   <span class="keywordflow">if</span>(!ss) tkid*=-1;
00048 
00049   <span class="keywordtype">int</span> layer = abs(tkid)/100;
00050   <span class="keywordtype">int</span> nchx  = (layer == 1 || layer == 8) ? TkDBc::Head-&gt;<a class="code" href="classTkDBc.html#o27">_NReadStripK7</a> 
00051                                          : TkDBc::Head-&gt;<a class="code" href="classTkDBc.html#o28">_NReadStripK5</a>;
00052   <span class="keywordtype">int</span> nchy  = TkDBc::Head-&gt;<a class="code" href="classTkDBc.html#o29">_NReadoutChanS</a>;
00053 
00054   <a class="code" href="classTkSens.html">TkSens</a> tks(tkid, <a class="code" href="classAMSTrMCCluster.html#o9">_xgl</a>);
00055   <span class="keywordtype">int</span> bcen0 = tks.<a class="code" href="classTkSens.html#a12">GetStripX</a>();
00056   <span class="keywordtype">int</span> bcen1 = tks.<a class="code" href="classTkSens.html#a13">GetStripY</a>();
00057 
00058   <span class="keywordtype">int</span> mult = 0;
00059 
00060   <span class="comment">// Convert from TDR address into sensor strip</span>
00061   <span class="keywordflow">if</span> (layer == 1 || layer == 8) {
00062     <span class="keywordtype">int</span> nad = TkDBc::Head-&gt;<a class="code" href="classTkDBc.html#o30">_NReadoutChanK</a>;
00063     <span class="keywordtype">int</span> sen = tks.<a class="code" href="classTkSens.html#a8">GetSensor</a>();
00064     <span class="keywordtype">int</span> idx = ((sen+1)*nchx-bcen0)/nad;
00065     bcen0 = bcen0+idx*nad-sen*nchx;
00066   }
00067   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tks.<a class="code" href="classTkSens.html#a8">GetSensor</a>()%2 == 1) bcen0 -= 192;
00068 
00069   <span class="keywordflow">if</span> (bcen0 &lt; 0) bcen0 = 0;
00070   <span class="keywordflow">if</span> (bcen1 &lt; 0) bcen1 = 0;
00071   <span class="keywordflow">if</span> (bcen0 &gt;= nchx) bcen0 = nchx-1;
00072   <span class="keywordflow">if</span> (bcen1 &gt;= nchy) bcen1 = nchy-1;
00073 
00074   <a class="code" href="classAMSTrMCCluster.html#o4">_center</a>[0] = bcen0;
00075   <a class="code" href="classAMSTrMCCluster.html#o4">_center</a>[1] = bcen1;
00076   <a class="code" href="classAMSTrMCCluster.html#o3">_left</a>  [0] = max(0,<a class="code" href="classAMSTrMCCluster.html#o4">_center</a>[0]-(5/2));
00077   <a class="code" href="classAMSTrMCCluster.html#o3">_left</a>  [1] = max(0,<a class="code" href="classAMSTrMCCluster.html#o4">_center</a>[1]-(5/2));
00078   <a class="code" href="classAMSTrMCCluster.html#o5">_right</a> [0] = min(nchx-1, <a class="code" href="classAMSTrMCCluster.html#o4">_center</a>[0]+(5/2));
00079   <a class="code" href="classAMSTrMCCluster.html#o5">_right</a> [1] = min(nchy-1, <a class="code" href="classAMSTrMCCluster.html#o4">_center</a>[1]+(5/2));
00080 
00081   <span class="keywordtype">float</span> xpr = <a class="code" href="classAMSTrMCCluster.html#o11">_sum</a>*<a class="code" href="tkdcards_8h.html#a2">TRMCFFKEY</a>.dedx2nprel;
00082   <span class="keywordflow">if</span> (xpr &lt;= 0) <span class="keywordflow">return</span>;
00083 
00084   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 2; k++) {
00085 
00086     <span class="comment">// fast algo</span>
00087 <span class="comment">//    if(fabs(dentry[k])/(xpr)&lt;TRMCFFKEY.fastswitch){</span>
00088     <span class="keywordflow">if</span>(1){
00089 
00090       <span class="keywordtype">double</span> s = <a class="code" href="classAMSTrMCCluster.html#e0">strip2x</a>(tkid, k, <a class="code" href="classAMSTrMCCluster.html#o4">_center</a>[k], mult);
00091       <span class="keywordtype">double</span> e = entry[k]-s;
00092       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =<a class="code" href="classAMSTrMCCluster.html#o3">_left</a>[k]; i &lt;= <a class="code" href="classAMSTrMCCluster.html#o5">_right</a>[k]; i++){
00093         <span class="keywordtype">double</span> a1 = <a class="code" href="classAMSTrMCCluster.html#e0">strip2x</a>(tkid, k, i, mult)-s;
00094         <span class="keywordtype">double</span> a2 = a1+<a class="code" href="classAMSTrMCCluster.html#e0">strip2x</a>(tkid, k, i+1, mult)-<a class="code" href="classAMSTrMCCluster.html#e0">strip2x</a>(tkid, k, i, mult);
00095         <a class="code" href="classAMSTrMCCluster.html#o6">_ss</a>[k][i-<a class="code" href="classAMSTrMCCluster.html#o3">_left</a>[k]] = <a class="code" href="tkdcards_8h.html#a2">TRMCFFKEY</a>.delta[k]*xpr*<a class="code" href="classAMSTrMCCluster.html#e2">fint2</a>(a1, a2, e, dentry[k], a2-a1);
00096       }
00097     }
00098 
00099     <span class="comment">//slow algo</span>
00100 <span class="comment">//    else std::cerr &lt;&lt; "Error: slow algo is not implemented" &lt;&lt; std::endl;</span>
00101 
00102     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code" href="classAMSTrMCCluster.html#o3">_left</a>[k]; i &lt;= <a class="code" href="classAMSTrMCCluster.html#o5">_right</a>[k]; i++)
00103       <a class="code" href="classAMSTrMCCluster.html#o6">_ss</a>[k][i-<a class="code" href="classAMSTrMCCluster.html#o3">_left</a>[k]] *= 1+<a class="code" href="TrDigi_8C.html#a0">rnormx</a>()*<a class="code" href="tkdcards_8h.html#a2">TRMCFFKEY</a>.gammaA[k];
00104   }
00105   <a class="code" href="classAMSTrMCCluster.html#o3">_left</a>[0]+=640;  <a class="code" href="classAMSTrMCCluster.html#o4">_center</a>[0]+=640;  <a class="code" href="classAMSTrMCCluster.html#o5">_right</a>[0]+=640;
00106 }
00107 
00108 
00109 
<a name="l00110"></a><a class="code" href="classAMSTrMCCluster.html#a4">00110</a> <span class="keywordtype">int</span> <a class="code" href="classAMSTrMCCluster.html#a4">AMSTrMCCluster::GetTkId</a>(){ 
00111   <span class="keywordtype">int</span> sensor = abs(<a class="code" href="classAMSTrMCCluster.html#o1">_idsoft</a>)/10000;
00112   <span class="keywordtype">int</span> tkid   = abs(<a class="code" href="classAMSTrMCCluster.html#o1">_idsoft</a>)%1000;
00113   <span class="keywordtype">int</span> ss     = abs(<a class="code" href="classAMSTrMCCluster.html#o1">_idsoft</a>)%10000-tkid;
00114   <span class="keywordflow">if</span>(!ss) tkid*=-1;
00115   
00116   <span class="keywordflow">return</span> tkid;
00117 }
00118 
00119 <span class="keywordtype">void</span> <a class="code" href="classAMSTrMCCluster.html#a14">AMSTrMCCluster::_printEl</a>(std::ostream &amp; stream)
00120 {
00121   <span class="keywordtype">int</span> sensor = abs(_idsoft)/10000;
00122   <span class="keywordtype">int</span> tkid   = abs(_idsoft)%1000;
00123   <span class="keywordtype">int</span> ss     = abs(_idsoft)%10000-tkid;
00124   <span class="keywordflow">if</span>(!ss) tkid*=-1;
00125 
00126   <span class="keywordtype">int</span> layer = abs(tkid)/100;
00127   stream &lt;&lt; <span class="stringliteral">"Impinging Particle: "</span>&lt;&lt;_itra&lt;&lt;<span class="stringliteral">" Px: "</span>&lt;&lt;_Momentum[0]
00128          &lt;&lt;<span class="stringliteral">" Py: "</span>&lt;&lt;_Momentum[1]&lt;&lt;<span class="stringliteral">" Pz: "</span>&lt;&lt;_Momentum[2]&lt;&lt;endl;
00129   stream &lt;&lt; <span class="stringliteral">"AMSTrMCCluster-Shower x "</span>&lt;&lt;_itra&lt;&lt;<span class="stringliteral">" "</span>&lt;&lt;layer&lt;&lt;<span class="stringliteral">" "</span>
00130          &lt;&lt; _left[0]&lt;&lt; <span class="stringliteral">" "</span>&lt;&lt;_center[0]&lt;&lt;<span class="stringliteral">" "</span>&lt;&lt;_right[0]&lt;&lt;<span class="stringliteral">" "</span>
00131          &lt;&lt;_ss[0][0]&lt;&lt;<span class="stringliteral">" "</span>&lt;&lt;_ss[0][1]&lt;&lt;<span class="stringliteral">" "</span>&lt;&lt;_ss[0][2]&lt;&lt;<span class="stringliteral">" "</span>
00132          &lt;&lt;_ss[0][3]&lt;&lt;<span class="stringliteral">" "</span>&lt;&lt;_ss[0][4]&lt;&lt; std::endl;
00133   stream &lt;&lt; <span class="stringliteral">"AMSTrMCCluster-Shower y "</span>&lt;&lt;_itra&lt;&lt;<span class="stringliteral">" "</span>&lt;&lt;layer&lt;&lt;<span class="stringliteral">" "</span>
00134          &lt;&lt; _left[1]&lt;&lt; <span class="stringliteral">" "</span>&lt;&lt;_center[1]&lt;&lt;<span class="stringliteral">" "</span>&lt;&lt;_right[1]&lt;&lt;<span class="stringliteral">" "</span>
00135          &lt;&lt;_ss[1][0]&lt;&lt;<span class="stringliteral">" "</span>&lt;&lt;_ss[1][1]&lt;&lt;<span class="stringliteral">" "</span>&lt;&lt;_ss[1][2]&lt;&lt;<span class="stringliteral">" "</span>
00136          &lt;&lt;_ss[1][3]&lt;&lt;<span class="stringliteral">" "</span>&lt;&lt;_ss[1][4]&lt;&lt; std::endl;
00137   stream &lt;&lt; <span class="stringliteral">"AMSTrMCCluster-Coo "</span>&lt;&lt;tkid&lt;&lt;<span class="stringliteral">" "</span>&lt;&lt;_idsoft&lt;&lt;<span class="stringliteral">" "</span>&lt;&lt;layer&lt;&lt;<span class="stringliteral">" "</span>
00138          &lt;&lt;_xca&lt;&lt;<span class="stringliteral">" "</span>&lt;&lt;_xcb&lt;&lt;<span class="stringliteral">" "</span>&lt;&lt;_xgl&lt;&lt; std::endl;
00139 }
00140 
00141 
<a name="l00142"></a><a class="code" href="classAMSTrMCCluster.html#e0">00142</a> <span class="keywordtype">float</span> <a class="code" href="classAMSTrMCCluster.html#e0">AMSTrMCCluster::strip2x</a>(<span class="keywordtype">int</span> tkid, <span class="keywordtype">int</span> side, <span class="keywordtype">int</span> strip, <span class="keywordtype">int</span> mult)
00143 {
00144   <span class="keywordtype">int</span> layer = abs(tkid)/100;
00145   <span class="keywordtype">int</span> nch   = (side  == 1) ? TkDBc::Head-&gt;<a class="code" href="classTkDBc.html#o29">_NReadoutChanS</a>
00146     : (layer == 1 || 
00147        layer == 8) ? TkDBc::Head-&gt;<a class="code" href="classTkDBc.html#o27">_NReadStripK7</a> 
00148     : TkDBc::Head-&gt;<a class="code" href="classTkDBc.html#o28">_NReadStripK5</a>;
00149 
00150 
00151   <span class="keywordtype">int</span> ss = strip;
00152   <span class="keywordflow">if</span> (ss &lt;=   0) ss = 1;
00153   <span class="keywordflow">if</span> (ss &gt;= nch) ss = nch-1;
00154 
00155   ss += (side == 0) ? TkDBc::Head-&gt;<a class="code" href="classTkDBc.html#o29">_NReadoutChanS</a> : 0;
00156   <span class="keywordtype">float</span> ss0 = <a class="code" href="classTkCoo.html#e2">TkCoo::GetLocalCoo</a>(tkid, ss-1, mult);
00157   <span class="keywordtype">float</span> ss1 = <a class="code" href="classTkCoo.html#e2">TkCoo::GetLocalCoo</a>(tkid, ss,   mult);
00158 
00159   <span class="keywordflow">if</span> (strip &lt;=   0) <span class="keywordflow">return</span> ss0-(ss0+ss1)/2;
00160   <span class="keywordflow">if</span> (strip &gt;= nch) <span class="keywordflow">return</span> ss1+(ss0+ss1)/2;
00161 
00162   <span class="keywordflow">return</span> (ss0+ss1)/2;
00163 }
00164 
<a name="l00165"></a><a class="code" href="classAMSTrMCCluster.html#e1">00165</a> <span class="keywordtype">double</span> <a class="code" href="classAMSTrMCCluster.html#e1">AMSTrMCCluster::fints</a>(<span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b)
00166 {
00167   <span class="keywordflow">if</span>      (a &gt;  0 &amp;&amp; b &gt;  0) <span class="keywordflow">return</span> <a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(a, 0)-<a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(b, 0);
00168   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a &lt;= 0 &amp;&amp; b &lt;= 0) <span class="keywordflow">return</span> <a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(b, 0)-<a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(a, 0);
00169   <span class="keywordflow">return</span> 2*<a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(0, 0)-<a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(a, 0)-<a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(b, 0);
00170 }
00171 
<a name="l00172"></a><a class="code" href="classAMSTrMCCluster.html#e2">00172</a> <span class="keywordtype">double</span> <a class="code" href="classAMSTrMCCluster.html#e2">AMSTrMCCluster::fint2</a>(<span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b, 
00173                           <span class="keywordtype">double</span> av, <span class="keywordtype">double</span> dav, <span class="keywordtype">double</span> dix)
00174 {
00175   <span class="keywordflow">if</span> (std::abs(dav)/dix &lt;= 0.01) <span class="keywordflow">return</span> <a class="code" href="classAMSTrMCCluster.html#e1">fints</a>(a-av, b-av);
00176 
00177   <span class="keywordtype">double</span> dlmin = av-std::abs(dav);
00178   <span class="keywordtype">double</span> dlmax = av+std::abs(dav);
00179   <span class="keywordflow">if</span> (a &lt;= dlmin &amp;&amp; b &gt;= dlmax) <span class="keywordflow">return</span> <a class="code" href="classAMSTrMCCluster.html#e3">fintc</a>(a, b, dlmin, dlmax);
00180   <span class="keywordflow">if</span> (a &lt;= dlmin &amp;&amp; b &lt;= dlmin) <span class="keywordflow">return</span> <a class="code" href="classAMSTrMCCluster.html#e5">fintl</a>(a, b, dlmin, dlmax);
00181   <span class="keywordflow">if</span> (a &gt;= dlmax &amp;&amp; b &gt;= dlmax) <span class="keywordflow">return</span> <a class="code" href="classAMSTrMCCluster.html#e4">fintr</a>(a, b, dlmin, dlmax);
00182 
00183   <span class="keywordflow">if</span> (a &lt;= dlmin &amp;&amp; b &lt;= dlmax)
00184     <span class="keywordflow">return</span> <a class="code" href="classAMSTrMCCluster.html#e3">fintc</a>(a, b, dlmin, b)*(b-dlmin)/(dlmax-dlmin)
00185           +<a class="code" href="classAMSTrMCCluster.html#e5">fintl</a>(a, b, b, dlmax)*(dlmax-b)/(dlmax-dlmin);
00186 
00187   <span class="keywordflow">if</span> (a &gt;= dlmin &amp;&amp; b &gt;= dlmax)
00188     <span class="keywordflow">return</span> <a class="code" href="classAMSTrMCCluster.html#e3">fintc</a>(a, b, a, dlmax)*(dlmax-a)/(dlmax-dlmin)
00189           +<a class="code" href="classAMSTrMCCluster.html#e4">fintr</a>(a, b, dlmin, a)*(a-dlmin)/(dlmax-dlmin);
00190 
00191   <span class="keywordflow">return</span> <a class="code" href="classAMSTrMCCluster.html#e3">fintc</a>(a, b, a,     b)*    (b-a)/(dlmax-dlmin)
00192         +<a class="code" href="classAMSTrMCCluster.html#e4">fintr</a>(a, b, dlmin, a)*(a-dlmin)/(dlmax-dlmin)
00193         +<a class="code" href="classAMSTrMCCluster.html#e5">fintl</a>(a, b, b, dlmax)*(dlmax-b)/(dlmax-dlmin);
00194 }
00195 
<a name="l00196"></a><a class="code" href="classAMSTrMCCluster.html#e3">00196</a> <span class="keywordtype">double</span> <a class="code" href="classAMSTrMCCluster.html#e3">AMSTrMCCluster::fintc</a>(<span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b, <span class="keywordtype">double</span> c, <span class="keywordtype">double</span> d)
00197 {
00198   <span class="keywordflow">return</span> 2*<a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(0,0)-(<a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(b-d,1)-<a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(b-c,1))/(d-c)
00199                      +(<a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(a-d,1)-<a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(a-c,1))/(d-c);
00200 }
00201 
<a name="l00202"></a><a class="code" href="classAMSTrMCCluster.html#e4">00202</a> <span class="keywordtype">double</span> <a class="code" href="classAMSTrMCCluster.html#e4">AMSTrMCCluster::fintr</a>(<span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b, <span class="keywordtype">double</span> c, <span class="keywordtype">double</span> d)
00203 {
00204   <span class="keywordflow">return</span> (-<a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(b-d,1)+<a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(b-c,1)
00205           +<a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(a-d,1)-<a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(a-c,1))/(d-c);
00206 }
00207 
<a name="l00208"></a><a class="code" href="classAMSTrMCCluster.html#e5">00208</a> <span class="keywordtype">double</span> <a class="code" href="classAMSTrMCCluster.html#e5">AMSTrMCCluster::fintl</a>(<span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b, <span class="keywordtype">double</span> c, <span class="keywordtype">double</span> d)
00209 {
00210   <span class="keywordflow">return</span> (-<a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(b-d,1)+<a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(b-c,1)
00211           +<a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(a-d,1)-<a class="code" href="classAMSTrMCCluster.html#e6">fdiff</a>(a-c,1))/(d-c);
00212 }
00213 
<a name="l00214"></a><a class="code" href="classAMSTrMCCluster.html#e6">00214</a> <span class="keywordtype">double</span> <a class="code" href="classAMSTrMCCluster.html#e6">AMSTrMCCluster::fdiff</a>(<span class="keywordtype">double</span> a, <span class="keywordtype">int</span> ialpha)
00215 {
00216   <span class="keywordtype">double</span> xl = std::abs(a)*<a class="code" href="tkdcards_8h.html#a2">TRMCFFKEY</a>.alpha;
00217   <span class="keywordflow">if</span> (xl &gt; 70) <span class="keywordflow">return</span> 0;
00218 
00219   <span class="keywordtype">double</span> diff = <a class="code" href="tkdcards_8h.html#a2">TRMCFFKEY</a>.beta*std::exp(-xl);
00220   <span class="keywordflow">if</span> (ialpha) diff /= <a class="code" href="tkdcards_8h.html#a2">TRMCFFKEY</a>.alpha;
00221 
00222   <span class="keywordflow">return</span> diff;
00223 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Nov 18 18:21:03 2008 for  AMS Software: Geometry Classes by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
