<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title> AMS Software: Geometry Classes: CC/TrRecHit.C Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">CC</a></div>
<h1>TrRecHit.C</h1><a href="TrRecHit_8C.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 
00002 
00003 
00004 
00005 
00006 
00007 
00008 
00009 
00010 
00011 
00012 
00013 
00014 
00015 
00016 
00017 
00018 <span class="preprocessor">#include "<a class="code" href="TrRecHit_8h.html">TrRecHit.h</a>"</span>
00019 <a class="code" href="TrTrack_8C.html#a0">ClassImp</a>(<a class="code" href="classAMSTrRecHit.html">AMSTrRecHit</a>);
<a name="l00020"></a><a class="code" href="classAMSTrRecHit.html#s0">00020</a> string AMSTrRecHit::sout;
00021 
00022 <span class="preprocessor">#ifdef __WRITEROOT_</span>
00023 <span class="preprocessor"></span><span class="preprocessor">#include "VCon_gbatch.h"</span>
00024 <a class="code" href="classVCon.html">VCon</a>* <a class="code" href="classAMSTrRecHit.html#s1">AMSTrRecHit::vcon</a>= <span class="keyword">new</span> VCon_gb();
00025 <span class="preprocessor">#else  </span>
00026 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="VCon__root_8h.html">VCon_root.h</a>"</span>
<a name="l00027"></a><a class="code" href="classAMSTrRecHit.html#s1">00027</a> <a class="code" href="classVCon.html">VCon</a>* <a class="code" href="classAMSTrRecHit.html#s1">AMSTrRecHit::vcon</a>= <span class="keyword">new</span> <a class="code" href="classVCon__root.html">VCon_root</a>();
00028 <span class="preprocessor">#endif</span>
00029 <span class="preprocessor"></span>
<a name="l00030"></a><a class="code" href="classAMSTrRecHit.html#a0">00030</a> <a class="code" href="classAMSTrRecHit.html#a0">AMSTrRecHit::AMSTrRecHit</a>(<span class="keywordtype">void</span>) {
00031   <a class="code" href="classAMSTrRecHit.html#a4">Clear</a>();
00032 }
00033 
00034 
<a name="l00035"></a><a class="code" href="classAMSTrRecHit.html#a1">00035</a> <a class="code" href="classAMSTrRecHit.html#a0">AMSTrRecHit::AMSTrRecHit</a>(<span class="keyword">const</span> <a class="code" href="classAMSTrRecHit.html">AMSTrRecHit</a>&amp; orig) {
00036   <a class="code" href="classAMSTrRecHit.html#o0">_tkid</a>     = orig.<a class="code" href="classAMSTrRecHit.html#o0">_tkid</a>;     
00037   <a class="code" href="classAMSTrRecHit.html#r0">_clusterX</a> = orig.<a class="code" href="classAMSTrRecHit.html#r0">_clusterX</a>;   
00038   <a class="code" href="classAMSTrRecHit.html#r1">_clusterY</a> = orig.<a class="code" href="classAMSTrRecHit.html#r1">_clusterY</a>;  
00039 
00040   <a class="code" href="classAMSTrRecHit.html#o7">_iclusterX</a> = orig.<a class="code" href="classAMSTrRecHit.html#o7">_iclusterX</a>;   
00041   <a class="code" href="classAMSTrRecHit.html#o8">_iclusterY</a> = orig.<a class="code" href="classAMSTrRecHit.html#o8">_iclusterY</a>;  
00042   <a class="code" href="classAMSTrRecHit.html#o1">_corr</a>     = orig.<a class="code" href="classAMSTrRecHit.html#o1">_corr</a>;
00043   <a class="code" href="classAMSTrRecHit.html#o2">_prob</a>     = orig.<a class="code" href="classAMSTrRecHit.html#o2">_prob</a>;     
00044   <a class="code" href="classAMSTrRecHit.html#o3">_status</a>   = orig.<a class="code" href="classAMSTrRecHit.html#o3">_status</a>;
00045   <a class="code" href="classAMSTrRecHit.html#o4">_mult</a>     = orig.<a class="code" href="classAMSTrRecHit.html#o4">_mult</a>;
00046   <a class="code" href="classAMSTrRecHit.html#o5">_imult</a>    = orig.<a class="code" href="classAMSTrRecHit.html#o5">_imult</a>;
00047   <a class="code" href="classAMSTrRecHit.html#r2">_coord</a>    = orig.<a class="code" href="classAMSTrRecHit.html#r2">_coord</a>;
00048   <a class="code" href="classAMSTrRecHit.html#o6">_residual</a> = orig.<a class="code" href="classAMSTrRecHit.html#o6">_residual</a>;
00049 }
00050 
00051 
<a name="l00052"></a><a class="code" href="classAMSTrRecHit.html#a2">00052</a> <a class="code" href="classAMSTrRecHit.html#a0">AMSTrRecHit::AMSTrRecHit</a>(<span class="keywordtype">int</span> tkid, <a class="code" href="classAMSTrCluster.html">AMSTrCluster</a>* clX, <a class="code" href="classAMSTrCluster.html">AMSTrCluster</a>* clY, <span class="keywordtype">float</span> corr, <span class="keywordtype">float</span> prob, <span class="keywordtype">int</span> status) {
00053   <a class="code" href="classAMSTrRecHit.html#o0">_tkid</a>     = tkid;     
00054   <a class="code" href="classAMSTrRecHit.html#r0">_clusterX</a> = clX;   
00055   <a class="code" href="classAMSTrRecHit.html#r1">_clusterY</a> = clY;   
00056   <a class="code" href="classVCon.html">VCon</a>* cont2=<a class="code" href="classAMSTrRecHit.html#s1">vcon</a>-&gt;<a class="code" href="classVCon.html#a2">GetCont</a>(<span class="stringliteral">"AMSTrCluster"</span>);
00057   <a class="code" href="classAMSTrRecHit.html#o7">_iclusterX</a> = cont2-&gt;<a class="code" href="classVCon.html#a6">getindex</a>(<a class="code" href="classAMSTrRecHit.html#r0">_clusterX</a>);
00058   <a class="code" href="classAMSTrRecHit.html#o8">_iclusterY</a> =cont2-&gt;<a class="code" href="classVCon.html#a6">getindex</a>(<a class="code" href="classAMSTrRecHit.html#r1">_clusterY</a>);
00059   <span class="keyword">delete</span> cont2;
00060   <a class="code" href="classAMSTrRecHit.html#o1">_corr</a>     = corr;
00061   <a class="code" href="classAMSTrRecHit.html#o2">_prob</a>     = prob;     
00062   <a class="code" href="classAMSTrRecHit.html#o3">_status</a>   = status;
00063   <span class="comment">// coordinate construction</span>
00064   <a class="code" href="classAMSTrRecHit.html#o4">_mult</a>     = (clX!=0) ? clX-&gt;<a class="code" href="classAMSTrCluster.html#a22">GetMultiplicity</a>() : 1;
00065   <a class="code" href="classAMSTrRecHit.html#o5">_imult</a>    = -1; 
00066   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> imult=0; imult&lt;_mult; imult++) <a class="code" href="classAMSTrRecHit.html#r2">_coord</a>.<a class="code" href="classAMSTrCluster.html#a3">push_back</a>(<a class="code" href="classAMSTrRecHit.html#a24">GetGlobalCoordinate</a>(imult));
00067   <a class="code" href="classAMSTrRecHit.html#o6">_residual</a>[0] = 0.;
00068   <a class="code" href="classAMSTrRecHit.html#o6">_residual</a>[1] = 0.;
00069   <a class="code" href="classAMSTrRecHit.html#o6">_residual</a>[2] = 0.;
00070 }
00071 
<a name="l00072"></a><a class="code" href="classAMSTrRecHit.html#a12">00072</a> <a class="code" href="classAMSTrCluster.html">AMSTrCluster</a>* <a class="code" href="classAMSTrRecHit.html#a12">AMSTrRecHit::GetXCluster</a>() { 
00073   <span class="keywordflow">if</span>(<a class="code" href="classAMSTrRecHit.html#r0">_clusterX</a>==NULL&amp;&amp; !(<a class="code" href="classAMSTrRecHit.html#o3">_status</a>&amp;YONLY)){
00074     <a class="code" href="classVCon.html">VCon</a>* cont2=<a class="code" href="classAMSTrRecHit.html#s1">vcon</a>-&gt;<a class="code" href="classVCon.html#a2">GetCont</a>(<span class="stringliteral">"AMSTrCluster"</span>);
00075     <a class="code" href="classAMSTrRecHit.html#r0">_clusterX</a> = (<a class="code" href="classAMSTrCluster.html">AMSTrCluster</a>*)cont2-&gt;<a class="code" href="classVCon.html#a5">getelem</a>(<a class="code" href="classAMSTrRecHit.html#o7">_iclusterX</a>);
00076     <span class="keyword">delete</span> cont2;
00077   }
00078   <span class="keywordflow">return</span> _clusterX;
00079 }
00080 
00081 
<a name="l00082"></a><a class="code" href="classAMSTrRecHit.html#a13">00082</a> <a class="code" href="classAMSTrCluster.html">AMSTrCluster</a>* <a class="code" href="classAMSTrRecHit.html#a13">AMSTrRecHit::GetYCluster</a>() { 
00083   <span class="keywordflow">if</span>(<a class="code" href="classAMSTrRecHit.html#r1">_clusterY</a>==NULL&amp;&amp; !(<a class="code" href="classAMSTrRecHit.html#o3">_status</a>&amp;XONLY)){
00084     <a class="code" href="classVCon.html">VCon</a>* cont2=<a class="code" href="classAMSTrRecHit.html#s1">vcon</a>-&gt;<a class="code" href="classVCon.html#a2">GetCont</a>(<span class="stringliteral">"AMSTrCluster"</span>);
00085     <a class="code" href="classAMSTrRecHit.html#r1">_clusterY</a> = (<a class="code" href="classAMSTrCluster.html">AMSTrCluster</a>*)cont2-&gt;<a class="code" href="classVCon.html#a5">getelem</a>(<a class="code" href="classAMSTrRecHit.html#o8">_iclusterY</a>);
00086     <span class="keyword">delete</span> cont2;
00087   }
00088   <span class="keywordflow">return</span> _clusterY;
00089 }
00090 
00091 
00092 
<a name="l00093"></a><a class="code" href="classAMSTrRecHit.html#a5">00093</a> <span class="keywordtype">void</span> <a class="code" href="classAMSTrRecHit.html#a5">AMSTrRecHit::BuildCoordinates</a>() {
00094   <span class="comment">// coordinate construction</span>
00095   <a class="code" href="classAMSTrCluster.html">AMSTrCluster</a>* clX= <a class="code" href="classAMSTrRecHit.html#a12">GetXCluster</a>();
00096   <a class="code" href="classAMSTrRecHit.html#o4">_mult</a>     = (clX!=0) ? clX-&gt;<a class="code" href="classAMSTrCluster.html#a22">GetMultiplicity</a>() : 1;
00097   <a class="code" href="classAMSTrRecHit.html#r2">_coord</a>.clear();
00098   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> imult=0; imult&lt;_mult; imult++) <a class="code" href="classAMSTrRecHit.html#r2">_coord</a>.<a class="code" href="classAMSTrCluster.html#a3">push_back</a>(<a class="code" href="classAMSTrRecHit.html#a24">GetGlobalCoordinate</a>(imult));
00099 }
00100 
<a name="l00101"></a><a class="code" href="classAMSTrRecHit.html#a3">00101</a> <a class="code" href="classAMSTrRecHit.html#a3">AMSTrRecHit::~AMSTrRecHit</a>() {
00102   <a class="code" href="classAMSTrRecHit.html#a4">Clear</a>();
00103 }
00104 
00105 
00106 
00107 
00108 
<a name="l00109"></a><a class="code" href="classAMSTrRecHit.html#a4">00109</a> <span class="keywordtype">void</span> <a class="code" href="classAMSTrRecHit.html#a4">AMSTrRecHit::Clear</a>() {
00110   <a class="code" href="classAMSTrRecHit.html#o0">_tkid</a>     = 0; 
00111   <a class="code" href="classAMSTrRecHit.html#r0">_clusterX</a> = 0;
00112   <a class="code" href="classAMSTrRecHit.html#r1">_clusterY</a> = 0;
00113   <a class="code" href="classAMSTrRecHit.html#o7">_iclusterX</a> = -1;
00114   <a class="code" href="classAMSTrRecHit.html#o8">_iclusterY</a> = -1;
00115   <a class="code" href="classAMSTrRecHit.html#o2">_prob</a>     = 0;
00116   <a class="code" href="classAMSTrRecHit.html#o3">_status</a>   = 0;
00117   <a class="code" href="classAMSTrRecHit.html#o4">_mult</a>     = 0;
00118   <a class="code" href="classAMSTrRecHit.html#o5">_imult</a>    = -1; 
00119   <a class="code" href="classAMSTrRecHit.html#r2">_coord</a>.clear();
00120   <a class="code" href="classAMSTrRecHit.html#o6">_residual</a>[0] = 0.;
00121   <a class="code" href="classAMSTrRecHit.html#o6">_residual</a>[1] = 0.;
00122   <a class="code" href="classAMSTrRecHit.html#o6">_residual</a>[2] = 0.;
00123 }
00124 
00125 
<a name="l00126"></a><a class="code" href="classAMSTrRecHit.html#a26">00126</a> <span class="keywordtype">void</span> <a class="code" href="classAMSTrRecHit.html#a26">AMSTrRecHit::Print</a>() { 
00127   <a class="code" href="classAMSTrRecHit.html#a27">Info</a>();
00128   cerr &lt;&lt;sout;
00129 }
<a name="l00130"></a><a class="code" href="classAMSTrRecHit.html#a27">00130</a> <span class="keywordtype">void</span> <a class="code" href="classAMSTrRecHit.html#a27">AMSTrRecHit::Info</a>() { 
00131   <span class="keywordtype">char</span> msg[1000];
00132   <a class="code" href="classAMSTrRecHit.html#s0">sout</a>.clear();
00133   sprintf(msg,<span class="stringliteral">"tkid: %+03d (x,y,z)=(%10.4f,%10.4f,%10.4f)  corr: %8.4f  prob: %7.5f  stat: %2d\n"</span>,
00134           <a class="code" href="classAMSTrRecHit.html#o0">_tkid</a>,<a class="code" href="classAMSTrRecHit.html#a17">GetCoord</a>(0).x(),<a class="code" href="classAMSTrRecHit.html#a17">GetCoord</a>(0).y(),<a class="code" href="classAMSTrRecHit.html#a17">GetCoord</a>(0).z(),<a class="code" href="classAMSTrRecHit.html#a9">GetCorrelation</a>(),<a class="code" href="classAMSTrRecHit.html#a10">GetProb</a>(),<a class="code" href="classAMSTrRecHit.html#a11">GetStatus</a>());
00135   <a class="code" href="classAMSTrRecHit.html#s0">sout</a>.append(msg);
00136   cout &lt;&lt;sout;
00137 }
00138 
<a name="l00139"></a><a class="code" href="classAMSTrRecHit.html#a25">00139</a> std::ostream &amp;<a class="code" href="classAMSTrRecHit.html#a25">AMSTrRecHit::putout</a>(std::ostream &amp;ostr)<span class="keyword"> const </span>{
00140   <span class="comment">//AMSPoint aa=this-&gt;GetGlobalCoordinate();</span>
00141   <span class="keywordflow">return</span> ostr &lt;&lt; <span class="stringliteral">"TkId: "</span> &lt;&lt; <a class="code" href="classAMSTrRecHit.html#a6">GetTkId</a>() &lt;&lt;<span class="stringliteral">"  Prob: "</span>&lt;&lt;<a class="code" href="classAMSTrRecHit.html#a10">GetProb</a>()&lt;&lt;endl;
00142     
00143 }
00144 
00145 
<a name="l00146"></a><a class="code" href="classAMSTrRecHit.html#a24">00146</a> AMSPoint <a class="code" href="classAMSTrRecHit.html#a24">AMSTrRecHit::GetGlobalCoordinate</a>(<span class="keywordtype">int</span> imult, <span class="keywordtype">char</span>* options) {
00147   <span class="comment">// parsing options</span>
00148   <span class="keywordtype">bool</span> ApplyAlignement = <span class="keyword">false</span>;
00149   <span class="keywordtype">char</span> character = <span class="charliteral">' '</span>;
00150   <span class="keywordtype">int</span>  cc = 0;
00151   <span class="keywordflow">while</span> (character!=<span class="charliteral">'\0'</span>) {
00152     character = *(options+cc);
00153     <span class="keywordflow">if</span> ( (character==<span class="charliteral">'A'</span>)||(character==<span class="charliteral">'a'</span>) ) ApplyAlignement = <span class="keyword">true</span>;
00154     cc++;
00155   }
00156   <span class="comment">// calculation</span>
00157   AMSPoint loc = <a class="code" href="classAMSTrRecHit.html#a23">GetLocalCoordinate</a>(imult);
00158   
00159   AMSPoint glo;
00160   <span class="keywordflow">if</span> (!ApplyAlignement) {
00161     <span class="keywordflow">if</span> (!<a class="code" href="classAMSTrRecHit.html#a12">GetXCluster</a>()) { glo = <a class="code" href="classTkCoo.html#e4">TkCoo::GetGlobalN</a>(<a class="code" href="classAMSTrRecHit.html#o0">_tkid</a>,0.,loc[1]); glo[0] = -1000.; <span class="keywordflow">return</span> glo; }
00162     <span class="keywordflow">if</span> (!<a class="code" href="classAMSTrRecHit.html#a13">GetYCluster</a>()) { glo = <a class="code" href="classTkCoo.html#e4">TkCoo::GetGlobalN</a>(<a class="code" href="classAMSTrRecHit.html#o0">_tkid</a>,loc[0],0.); glo[1] = -1000.; <span class="keywordflow">return</span> glo; }
00163     glo = <a class="code" href="classTkCoo.html#e4">TkCoo::GetGlobalN</a>(<a class="code" href="classAMSTrRecHit.html#a6">GetTkId</a>(),loc);
00164   }
00165   <span class="keywordflow">else</span> {
00166     <span class="keywordflow">if</span> (!<a class="code" href="classAMSTrRecHit.html#a12">GetXCluster</a>()) { glo = <a class="code" href="classTkCoo.html#e7">TkCoo::GetGlobalA</a>(<a class="code" href="classAMSTrRecHit.html#o0">_tkid</a>,0.,loc[1]); glo[0] = -1000.; <span class="keywordflow">return</span> glo; }
00167     <span class="keywordflow">if</span> (!<a class="code" href="classAMSTrRecHit.html#a13">GetYCluster</a>()) { glo = <a class="code" href="classTkCoo.html#e7">TkCoo::GetGlobalA</a>(<a class="code" href="classAMSTrRecHit.html#o0">_tkid</a>,loc[0],0.); glo[1] = -1000.; <span class="keywordflow">return</span> glo; }
00168     glo = <a class="code" href="classTkCoo.html#e7">TkCoo::GetGlobalA</a>(<a class="code" href="classAMSTrRecHit.html#a6">GetTkId</a>(),loc);
00169   }
00170   <span class="keywordflow">return</span> glo;
00171 }
00172 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Nov 18 18:21:03 2008 for  AMS Software: Geometry Classes by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
